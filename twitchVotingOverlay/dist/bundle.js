(()=>{"use strict";var t=function(){function t(){this.handlers=[]}return t.prototype.addEventListener=function(t){this.handlers.push(t)},t.prototype.removeEventListener=function(t){this.handlers=this.handlers.filter((function(e){return e!==t}))},t.prototype.dispatch=function(t){this.handlers.slice(0).forEach((function(e){return e(t)}))},t}(),e=function(){function e(e){this.WS=null,this.createEvent=new t,this.connectEvent=new t,this.disconnectEvent=new t,this.endEvent=new t,this.noVoteRoundEvent=new t,this.updateEvent=new t,this.URL=e,this.onSocketClose=this.onSocketClose.bind(this),this.onSocketError=this.onSocketError.bind(this),this.onSocketMessage=this.onSocketMessage.bind(this),this.onSocketOpen=this.onSocketOpen.bind(this),this.connect()}return e.prototype.addCreateVoteListener=function(t){this.createEvent.addEventListener(t)},e.prototype.addConnectListener=function(t){this.connectEvent.addEventListener(t)},e.prototype.addDisconnectListener=function(t){this.disconnectEvent.addEventListener(t)},e.prototype.addEndVoteListener=function(t){this.endEvent.addEventListener(t)},e.prototype.addNoVotingRoundListener=function(t){this.noVoteRoundEvent.addEventListener(t)},e.prototype.addUpdateVoteListener=function(t){this.updateEvent.addEventListener(t)},e.prototype.removeCreateVoteListener=function(t){this.createEvent.removeEventListener(t)},e.prototype.removeConnectListener=function(t){this.connectEvent.removeEventListener(t)},e.prototype.removeDisconnectListener=function(t){this.disconnectEvent.removeEventListener(t)},e.prototype.removeEndVoteListener=function(t){this.endEvent.removeEventListener(t)},e.prototype.removeNoVotingRoundListener=function(t){this.noVoteRoundEvent.removeEventListener(t)},e.prototype.removeUpdateVoteListener=function(t){this.updateEvent.removeEventListener(t)},e.prototype.connect=function(){try{this.WS=new WebSocket(this.URL),this.WS.addEventListener("close",this.onSocketClose),this.WS.addEventListener("error",this.onSocketError),this.WS.addEventListener("message",this.onSocketMessage),this.WS.addEventListener("open",this.onSocketOpen)}catch(t){}},e.prototype.onSocketError=function(t){console.log("error in socket occurred: ".concat(t.message,". closing socket")),null!==this.WS&&this.WS.close()},e.prototype.onSocketClose=function(){var t=this;console.log("socket closed, reconnecting in ".concat(e.RECONNECT_INTERVAL,"ms")),this.disconnectEvent.dispatch(null),window.setTimeout((function(){return t.connect()}),e.RECONNECT_INTERVAL)},e.prototype.onSocketMessage=function(t){try{var e=JSON.parse(t.data);switch(e.request){case"CREATE":this.createEvent.dispatch(e);break;case"END":this.endEvent.dispatch(e);break;case"NO_VOTING_ROUND":this.noVoteRoundEvent.dispatch(e);break;case"UPDATE":this.updateEvent.dispatch(e);break;default:console.warn("unknown request type: ".concat(e.request))}}catch(t){console.error("failed to parse json data: ".concat(t))}},e.prototype.onSocketOpen=function(){console.log("successfully connected to websocket"),this.connectEvent.dispatch(null)},e.RECONNECT_INTERVAL=1e3,e}(),n=600,o=function(){function t(t){this.container=t,this.bar=document.createElement("div"),this.barProgression=document.createElement("div"),this.labelContainer=document.createElement("div"),this.labelLabel=document.createElement("span"),this.labelMatch=document.createElement("span"),this.labelValue=document.createElement("span"),this.bar.classList.add("bar"),this.barProgression.classList.add("progression"),this.labelContainer.classList.add("labelContainer"),this.labelContainer.append(this.labelMatch,this.labelLabel,this.labelValue),this.bar.append(this.barProgression),this.bar.append(this.labelContainer),this.container.append(this.bar)}return Object.defineProperty(t.prototype,"isDisabled",{set:function(t){var e="disabled";t?(this.bar.classList.add(e),this.barProgression.classList.add(e),this.labelContainer.classList.add(e)):(this.bar.classList.remove(e),this.labelContainer.classList.remove(e),this.barProgression.classList.remove(e))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"label",{set:function(t){this.labelLabel.innerText=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"match",{set:function(t){this.labelMatch.innerText=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{set:function(t){this.labelValue.innerText=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{set:function(t){this.barProgression.style.width=t},enumerable:!1,configurable:!0}),t.prototype.fadeIn=function(t,e){void 0===e&&(e=0),this.bar.style.animationDelay="".concat(e,"ms"),this.bar.style.animationDuration="".concat(t,"ms"),this.bar.classList.add("slideIn"),this.bar.classList.remove("slideOut")},t.prototype.fadeOut=function(t,e){void 0===e&&(e=0),this.bar.style.animationDelay="".concat(e,"ms"),this.bar.style.animationDuration="".concat(t,"ms"),this.bar.classList.add("slideOut"),this.bar.classList.remove("slideIn")},t}(),i=function(){function t(t,e){this.bars=[],this.container=t,this.onCreateVote=this.onCreateVote.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.onEndVote=this.onEndVote.bind(this),this.onUpdateVote=this.onUpdateVote.bind(this),e.addCreateVoteListener(this.onCreateVote),e.addDisconnectListener(this.onDisconnect),e.addEndVoteListener(this.onEndVote),e.addUpdateVoteListener(this.onUpdateVote)}return t.prototype.onCreateVote=function(){this.bars.forEach((function(t,e){var o=100*e;t.fadeOut(n,o),setTimeout((function(){t.isDisabled=!1,t.fadeIn(n,o)}),n+o)}))},t.prototype.onDisconnect=function(){this.bars.forEach((function(t,e){var o=100*e;t.fadeOut(n,o)}))},t.prototype.onEndVote=function(){this.bars.forEach((function(t){return t.isDisabled=!0}))},t.prototype.onUpdateVote=function(t){var e=this,n=t.retainInitialVotes,i=t.voteOptions,s=t.votingMode,r=t.totalVotes;if("PERCENTAGE"!==s||0!==r&&!n||(r+=i.length,i.forEach((function(t){return t.value++}))),i.length!==this.bars.length){for(;this.container.firstChild;)this.container.removeChild(this.container.firstChild);this.bars=i.map((function(t){return new o(e.container)}))}for(var a=0;a<i.length;a++){var c=this.bars[a],d=i[a];if(!c.isDisabled){var h;h=0===d.value?0:Math.floor(d.value/r*100),c.label=d.label,c.match=d.matches.join("/").concat("."),"MAJORITY"===s||"ANTIMAJORITY"===s?c.value=d.value.toString():"PERCENTAGE"===s&&(c.value="".concat(h,"%")),c.width="".concat(h,"%")}}},t}(),s=document.getElementById("barContainer"),r=document.getElementById("totalVotes");if(null===s)throw new Error("could not find bar container in DOM");if(null===r)throw new Error("could not find total votes element in DOM");var a=new e("ws://localhost:9091");a.addConnectListener((function(){r.style.opacity="1"})),a.addDisconnectListener((function(){r.style.opacity="0"})),a.addUpdateVoteListener((function(t){r.innerText="Total Votes: ".concat(t.totalVotes)})),new i(s,a)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UyxFQUFJaEMsTUFBUSxVQUFHa0MsRUFBVSxNQUcxQkYsRUFBSTNCLE1BQVEsVUFBRzZCLEVBQVUsSUFmRyxDLENBaUI5QixFQUNELEVBN0VBLEdDMUVNUyxFQUFnQnJELFNBQVNzRCxlQUFlLGdCQUN4Q0MsRUFBY3ZELFNBQVNzRCxlQUFlLGNBRTVDLEdBQXNCLE9BQWxCRCxFQUF3QixNQUFNLElBQUlHLE1BQU0sdUNBQzVDLEdBQW9CLE9BQWhCRCxFQUFzQixNQUFNLElBQUlDLE1BQU0sNkNBRTFDLElBQU1DLEVBQWlCLElBQUlyRSxFQUFtQix1QkFFOUNxRSxFQUFldkYsb0JBQW1CLFdBQ2pDcUYsRUFBWXpDLE1BQU00QyxRQUFVLEdBQzdCLElBQ0FELEVBQWV0Rix1QkFBc0IsV0FDcENvRixFQUFZekMsTUFBTTRDLFFBQVUsR0FDN0IsSUFDQUQsRUFBZW5GLHVCQUFzQixTQUFBWSxHQUNwQ3FFLEVBQVkxQyxVQUFZLHVCQUFnQjNCLEVBQVFnRCxXQUNqRCxJQUVBLElBQUl5QixFQUFXTixFQUFlSSxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHdpdGNoVm90aW5nT3ZlcmxheS8uL3NyYy9saWdodEV2ZW50L2xpZ2h0RXZlbnQudHMiLCJ3ZWJwYWNrOi8vdHdpdGNoVm90aW5nT3ZlcmxheS8uL3NyYy9jaGFvc092ZXJsYXlDbGllbnQvY2xpZW50LnRzIiwid2VicGFjazovL3R3aXRjaFZvdGluZ092ZXJsYXkvLi9zcmMvYmFyT3ZlcmxheS50cyIsIndlYnBhY2s6Ly90d2l0Y2hWb3RpbmdPdmVybGF5Ly4vc3JjL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElMaXRlRXZlbnQgfSBmcm9tICcuL2lMaWdodEV2ZW50JztcclxuXHJcbmV4cG9ydCBjbGFzcyBMaXRlRXZlbnQ8VCA9IG51bGw+IGltcGxlbWVudHMgSUxpdGVFdmVudDxUPiB7XHJcblx0cHJpdmF0ZSBoYW5kbGVyczogKChkYXRhOiBUKSA9PiB2b2lkKVtdID0gW107XHJcblxyXG5cdHB1YmxpYyBhZGRFdmVudExpc3RlbmVyKGhhbmRsZXI6IChkYXRhOiBUKSA9PiB2b2lkKTogdm9pZCB7XHJcblx0XHR0aGlzLmhhbmRsZXJzLnB1c2goaGFuZGxlcik7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgcmVtb3ZlRXZlbnRMaXN0ZW5lcihoYW5kbGVyOiAoZGF0YTogVCkgPT4gdm9pZCk6IHZvaWQge1xyXG5cdFx0dGhpcy5oYW5kbGVycyA9IHRoaXMuaGFuZGxlcnMuZmlsdGVyKGggPT4gaCAhPT0gaGFuZGxlcik7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZGlzcGF0Y2goZGF0YTogVCkge1xyXG5cdFx0dGhpcy5oYW5kbGVycy5zbGljZSgwKS5mb3JFYWNoKGggPT4gaChkYXRhKSk7XHJcblx0fVxyXG59XHJcbiIsImltcG9ydCB7IElDaGFvc092ZXJsYXlDbGllbnQgfSBmcm9tICcuL2lDbGllbnQnO1xyXG5pbXBvcnQgeyBMaXRlRXZlbnQgfSBmcm9tICcuLi9saWdodEV2ZW50JztcclxuaW1wb3J0IHsgSUNoYW9zT3ZlcmxheVZvdGVPcHRpb24gfSBmcm9tICcuL2lWb3RlT3B0aW9uJztcclxuaW1wb3J0IHsgSUNoYW9zT3ZlcmxheUNsaWVudE1lc3NhZ2UgfSBmcm9tICcuL2lNZXNzYWdlJztcclxuaW1wb3J0IHsgVENoYW9zT3ZlcmxheUNsaWVudEV2ZW50IH0gZnJvbSAnLi90RXZlbnQnO1xyXG5cclxuZXhwb3J0IGNsYXNzIENoYW9zT3ZlcmxheUNsaWVudCBpbXBsZW1lbnRzIElDaGFvc092ZXJsYXlDbGllbnQge1xyXG5cdC8qKlxyXG5cdCAqIEludGVydmFsIGluIHdoaWNoIHRoZSB3ZWJzb2NrZXQgY2xpZW50IHRyaWVzIHRvIHJlY29ubmVjdCB0b1xyXG5cdCAqIHRoZSBzZXJ2ZXJcclxuXHQgKi9cclxuXHRwdWJsaWMgc3RhdGljIFJFQ09OTkVDVF9JTlRFUlZBTCA9IDEwMDA7XHJcblxyXG5cdHByaXZhdGUgVVJMOiBzdHJpbmc7XHJcblx0cHJpdmF0ZSBXUzogV2ViU29ja2V0IHwgbnVsbCA9IG51bGw7XHJcblx0cHJpdmF0ZSBjcmVhdGVFdmVudCA9IG5ldyBMaXRlRXZlbnQ8SUNoYW9zT3ZlcmxheUNsaWVudE1lc3NhZ2U+KCk7XHJcblx0cHJpdmF0ZSBjb25uZWN0RXZlbnQgPSBuZXcgTGl0ZUV2ZW50KCk7XHJcblx0cHJpdmF0ZSBkaXNjb25uZWN0RXZlbnQgPSBuZXcgTGl0ZUV2ZW50KCk7XHJcblx0cHJpdmF0ZSBlbmRFdmVudCA9IG5ldyBMaXRlRXZlbnQ8SUNoYW9zT3ZlcmxheUNsaWVudE1lc3NhZ2U+KCk7XHJcblx0cHJpdmF0ZSBub1ZvdGVSb3VuZEV2ZW50ID0gbmV3IExpdGVFdmVudDxJQ2hhb3NPdmVybGF5Q2xpZW50TWVzc2FnZT4oKTtcclxuXHRwcml2YXRlIHVwZGF0ZUV2ZW50ID0gbmV3IExpdGVFdmVudDxJQ2hhb3NPdmVybGF5Q2xpZW50TWVzc2FnZT4oKTtcclxuXHJcblx0cHVibGljIGNvbnN0cnVjdG9yKFVSTDogc3RyaW5nKSB7XHJcblx0XHR0aGlzLlVSTCA9IFVSTDtcclxuXHJcblx0XHQvLyBCaW5kIHRoZSBsaXN0ZW5lciBtZXRob2RzXHJcblx0XHR0aGlzLm9uU29ja2V0Q2xvc2UgPSB0aGlzLm9uU29ja2V0Q2xvc2UuYmluZCh0aGlzKTtcclxuXHRcdHRoaXMub25Tb2NrZXRFcnJvciA9IHRoaXMub25Tb2NrZXRFcnJvci5iaW5kKHRoaXMpO1xyXG5cdFx0dGhpcy5vblNvY2tldE1lc3NhZ2UgPSB0aGlzLm9uU29ja2V0TWVzc2FnZS5iaW5kKHRoaXMpO1xyXG5cdFx0dGhpcy5vblNvY2tldE9wZW4gPSB0aGlzLm9uU29ja2V0T3Blbi5iaW5kKHRoaXMpO1xyXG5cclxuXHRcdHRoaXMuY29ubmVjdCgpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGFkZENyZWF0ZVZvdGVMaXN0ZW5lcihsaXN0ZW5lcjogVENoYW9zT3ZlcmxheUNsaWVudEV2ZW50KTogdm9pZCB7XHJcblx0XHR0aGlzLmNyZWF0ZUV2ZW50LmFkZEV2ZW50TGlzdGVuZXIobGlzdGVuZXIpO1xyXG5cdH1cclxuXHRwdWJsaWMgYWRkQ29ubmVjdExpc3RlbmVyKGxpc3RlbmVyOiAoKSA9PiB2b2lkKTogdm9pZCB7XHJcblx0XHR0aGlzLmNvbm5lY3RFdmVudC5hZGRFdmVudExpc3RlbmVyKGxpc3RlbmVyKTtcclxuXHR9XHJcblx0cHVibGljIGFkZERpc2Nvbm5lY3RMaXN0ZW5lcihsaXN0ZW5lcjogKCkgPT4gdm9pZCk6IHZvaWQge1xyXG5cdFx0dGhpcy5kaXNjb25uZWN0RXZlbnQuYWRkRXZlbnRMaXN0ZW5lcihsaXN0ZW5lcik7XHJcblx0fVxyXG5cdHB1YmxpYyBhZGRFbmRWb3RlTGlzdGVuZXIobGlzdGVuZXI6IFRDaGFvc092ZXJsYXlDbGllbnRFdmVudCk6IHZvaWQge1xyXG5cdFx0dGhpcy5lbmRFdmVudC5hZGRFdmVudExpc3RlbmVyKGxpc3RlbmVyKTtcclxuXHR9XHJcblx0cHVibGljIGFkZE5vVm90aW5nUm91bmRMaXN0ZW5lcihsaXN0ZW5lcjogVENoYW9zT3ZlcmxheUNsaWVudEV2ZW50KTogdm9pZCB7XHJcblx0XHR0aGlzLm5vVm90ZVJvdW5kRXZlbnQuYWRkRXZlbnRMaXN0ZW5lcihsaXN0ZW5lcik7XHJcblx0fVxyXG5cdHB1YmxpYyBhZGRVcGRhdGVWb3RlTGlzdGVuZXIobGlzdGVuZXI6IFRDaGFvc092ZXJsYXlDbGllbnRFdmVudCk6IHZvaWQge1xyXG5cdFx0dGhpcy51cGRhdGVFdmVudC5hZGRFdmVudExpc3RlbmVyKGxpc3RlbmVyKTtcclxuXHR9XHJcblx0cHVibGljIHJlbW92ZUNyZWF0ZVZvdGVMaXN0ZW5lcihsaXN0ZW5lcjogVENoYW9zT3ZlcmxheUNsaWVudEV2ZW50KTogdm9pZCB7XHJcblx0XHR0aGlzLmNyZWF0ZUV2ZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIobGlzdGVuZXIpO1xyXG5cdH1cclxuXHRwdWJsaWMgcmVtb3ZlQ29ubmVjdExpc3RlbmVyKGxpc3RlbmVyOiAoKSA9PiB2b2lkKTogdm9pZCB7XHJcblx0XHR0aGlzLmNvbm5lY3RFdmVudC5yZW1vdmVFdmVudExpc3RlbmVyKGxpc3RlbmVyKTtcclxuXHR9XHJcblx0cHVibGljIHJlbW92ZURpc2Nvbm5lY3RMaXN0ZW5lcihsaXN0ZW5lcjogKCkgPT4gdm9pZCk6IHZvaWQge1xyXG5cdFx0dGhpcy5kaXNjb25uZWN0RXZlbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihsaXN0ZW5lcik7XHJcblx0fVxyXG5cdHB1YmxpYyByZW1vdmVFbmRWb3RlTGlzdGVuZXIobGlzdGVuZXI6IFRDaGFvc092ZXJsYXlDbGllbnRFdmVudCk6IHZvaWQge1xyXG5cdFx0dGhpcy5lbmRFdmVudC5yZW1vdmVFdmVudExpc3RlbmVyKGxpc3RlbmVyKTtcclxuXHR9XHJcblx0cHVibGljIHJlbW92ZU5vVm90aW5nUm91bmRMaXN0ZW5lcihsaXN0ZW5lcjogVENoYW9zT3ZlcmxheUNsaWVudEV2ZW50KTogdm9pZCB7XHJcblx0XHR0aGlzLm5vVm90ZVJvdW5kRXZlbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihsaXN0ZW5lcik7XHJcblx0fVxyXG5cdHB1YmxpYyByZW1vdmVVcGRhdGVWb3RlTGlzdGVuZXIobGlzdGVuZXI6IFRDaGFvc092ZXJsYXlDbGllbnRFdmVudCk6IHZvaWQge1xyXG5cdFx0dGhpcy51cGRhdGVFdmVudC5yZW1vdmVFdmVudExpc3RlbmVyKGxpc3RlbmVyKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENvbm5lY3RzIHRvIHRoZSB3ZWJzb2NrZXQgc2VydmVyIGFuZCBhZGRzIGV2ZW50IGxpc3RlbmVyc1xyXG5cdCAqL1xyXG5cdHByaXZhdGUgY29ubmVjdCgpOiB2b2lkIHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdHRoaXMuV1MgPSBuZXcgV2ViU29ja2V0KHRoaXMuVVJMKTtcclxuXHRcdFx0dGhpcy5XUy5hZGRFdmVudExpc3RlbmVyKCdjbG9zZScsIHRoaXMub25Tb2NrZXRDbG9zZSk7XHJcblx0XHRcdC8vIFwiYXMgYW55XCIgaXMgcmVxdWlyZWQgYmVjYXVzZSB0eXBlc2NyaXB0IHRoaW5rcyB0aGF0IHRoZSB3ZWJzb2NrZXQgXCJvbkVycm9yXCJcclxuXHRcdFx0Ly8gaGFzIGFuIGV2ZW50LCBhbmQgbm90IGFuZCBlcnJvciBhcyBjYWxsYmFjayBkYXRhXHJcblx0XHRcdHRoaXMuV1MuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCB0aGlzLm9uU29ja2V0RXJyb3IgYXMgYW55KTtcclxuXHRcdFx0dGhpcy5XUy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5vblNvY2tldE1lc3NhZ2UpO1xyXG5cdFx0XHR0aGlzLldTLmFkZEV2ZW50TGlzdGVuZXIoJ29wZW4nLCB0aGlzLm9uU29ja2V0T3Blbik7XHJcblx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdC8vIElmIHRoZSB3ZWJzb2NrZXQgY29ubmVjdGlvbiBmYWlscyB3ZSBnZXQgYW4gZXJyb3IsXHJcblx0XHRcdC8vIHRoaXMgaXMgY2F1Z2h0IGJ5IHRoZSBcIm9uRXJyb3JcIiBjYWxsYmFja1xyXG5cdFx0fVxyXG5cdH1cclxuXHQvKipcclxuXHQgKiBDYWxsYmFjayBmb3IgdGhlIHdlYnNvY2tldCBjbGllbnQgLSBjYWxsZWQgb24gZXJyb3JzXHJcblx0ICogQHBhcmFtIGVycm9yIHdoYXQgd2VudCB3cm9uZ1xyXG5cdCAqL1xyXG5cdHByaXZhdGUgb25Tb2NrZXRFcnJvcihlcnJvcjogRXJyb3IpOiB2b2lkIHtcclxuXHRcdGNvbnNvbGUubG9nKGBlcnJvciBpbiBzb2NrZXQgb2NjdXJyZWQ6ICR7ZXJyb3IubWVzc2FnZX0uIGNsb3Npbmcgc29ja2V0YCk7XHJcblx0XHRpZiAodGhpcy5XUyAhPT0gbnVsbCkgdGhpcy5XUy5jbG9zZSgpO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBDYWxsYmFjayBmb3IgdGhlIHdlYnNvY2tldCBjbGllbnQgLSBjYWxsZWQgb24gc29ja2V0IGNsb3NlXHJcblx0ICovXHJcblx0cHJpdmF0ZSBvblNvY2tldENsb3NlKCk6IHZvaWQge1xyXG5cdFx0Y29uc29sZS5sb2coYHNvY2tldCBjbG9zZWQsIHJlY29ubmVjdGluZyBpbiAke0NoYW9zT3ZlcmxheUNsaWVudC5SRUNPTk5FQ1RfSU5URVJWQUx9bXNgKTtcclxuXHRcdHRoaXMuZGlzY29ubmVjdEV2ZW50LmRpc3BhdGNoKG51bGwpO1xyXG5cdFx0d2luZG93LnNldFRpbWVvdXQoKCkgPT4gdGhpcy5jb25uZWN0KCksIENoYW9zT3ZlcmxheUNsaWVudC5SRUNPTk5FQ1RfSU5URVJWQUwpO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBDYWxsYmFjayBmb3IgdGhlIHdlYnNvY2tldCBjbGllbnQgLSBjYWxsZWQgd2hlbiBhIG1lc3NhZ2UgaXMgcmVjZWl2ZWRcclxuXHQgKiBAcGFyYW0gbWVzc2FnZSBtZXNzYWdlIHRoYXQgd2FzIHJlY2VpdmVkXHJcblx0ICovXHJcblx0cHJpdmF0ZSBvblNvY2tldE1lc3NhZ2UobWVzc2FnZTogTWVzc2FnZUV2ZW50KTogdm9pZCB7XHJcblx0XHR0cnkge1xyXG5cdFx0XHRjb25zdCBNRVNTQUdFOiBJQ2hhb3NPdmVybGF5Q2xpZW50TWVzc2FnZSA9IEpTT04ucGFyc2UobWVzc2FnZS5kYXRhKTtcclxuXHJcblx0XHRcdHN3aXRjaCAoTUVTU0FHRS5yZXF1ZXN0KSB7XHJcblx0XHRcdFx0Y2FzZSAnQ1JFQVRFJzpcclxuXHRcdFx0XHRcdHRoaXMuY3JlYXRlRXZlbnQuZGlzcGF0Y2goTUVTU0FHRSk7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlICdFTkQnOlxyXG5cdFx0XHRcdFx0dGhpcy5lbmRFdmVudC5kaXNwYXRjaChNRVNTQUdFKTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgJ05PX1ZPVElOR19ST1VORCc6XHJcblx0XHRcdFx0XHR0aGlzLm5vVm90ZVJvdW5kRXZlbnQuZGlzcGF0Y2goTUVTU0FHRSk7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlICdVUERBVEUnOlxyXG5cdFx0XHRcdFx0dGhpcy51cGRhdGVFdmVudC5kaXNwYXRjaChNRVNTQUdFKTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGRlZmF1bHQ6XHJcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oYHVua25vd24gcmVxdWVzdCB0eXBlOiAke01FU1NBR0UucmVxdWVzdH1gKTtcclxuXHRcdFx0fVxyXG5cdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRjb25zb2xlLmVycm9yKGBmYWlsZWQgdG8gcGFyc2UganNvbiBkYXRhOiAke2V9YCk7XHJcblx0XHR9XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIENhbGxiYWNrIGZvciB0aGUgd2Vic29ja2V0IGNsaWVudCAtIGNhbGxlZCBvbiBzb2NrZXQgb3BlblxyXG5cdCAqL1xyXG5cdHByaXZhdGUgb25Tb2NrZXRPcGVuKCk6IHZvaWQge1xyXG5cdFx0Y29uc29sZS5sb2coJ3N1Y2Nlc3NmdWxseSBjb25uZWN0ZWQgdG8gd2Vic29ja2V0Jyk7XHJcblx0XHR0aGlzLmNvbm5lY3RFdmVudC5kaXNwYXRjaChudWxsKTtcclxuXHR9XHJcbn1cclxuIiwiaW1wb3J0IHsgSUNoYW9zT3ZlcmxheUNsaWVudCB9IGZyb20gJy4vY2hhb3NPdmVybGF5Q2xpZW50L2lDbGllbnQnO1xyXG5pbXBvcnQgeyBJQ2hhb3NPdmVybGF5Q2xpZW50TWVzc2FnZSB9IGZyb20gJy4vY2hhb3NPdmVybGF5Q2xpZW50L2lNZXNzYWdlJztcclxuXHJcbmNvbnN0IEFOSU1BVElPTl9ERUxBWV9ERUxUQSA9IDEwMDtcclxuY29uc3QgQU5JTUFUSU9OX0xFTkdUSCA9IDYwMDtcclxuXHJcbmNsYXNzIEJhciB7XHJcblx0cHJpdmF0ZSBiYXI6IEhUTUxEaXZFbGVtZW50O1xyXG5cdHByaXZhdGUgYmFyUHJvZ3Jlc3Npb246IEhUTUxEaXZFbGVtZW50O1xyXG5cdHByaXZhdGUgY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudDtcclxuXHRwcml2YXRlIGxhYmVsTGFiZWw6IEhUTUxTcGFuRWxlbWVudDtcclxuXHRwcml2YXRlIGxhYmVsTWF0Y2g6IEhUTUxTcGFuRWxlbWVudDtcclxuXHRwcml2YXRlIGxhYmVsVmFsdWU6IEhUTUxTcGFuRWxlbWVudDtcclxuXHRwcml2YXRlIGxhYmVsQ29udGFpbmVyOiBIVE1MRGl2RWxlbWVudDtcclxuXHJcblx0cHVibGljIGNvbnN0cnVjdG9yKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpIHtcclxuXHRcdHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG5cclxuXHRcdC8vIENvbnN0cnVjdCBiYXJcclxuXHRcdHRoaXMuYmFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcblx0XHR0aGlzLmJhclByb2dyZXNzaW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcblx0XHR0aGlzLmxhYmVsQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcblx0XHR0aGlzLmxhYmVsTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcblx0XHR0aGlzLmxhYmVsTWF0Y2ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcblx0XHR0aGlzLmxhYmVsVmFsdWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcblxyXG5cdFx0dGhpcy5iYXIuY2xhc3NMaXN0LmFkZCgnYmFyJyk7XHJcblx0XHR0aGlzLmJhclByb2dyZXNzaW9uLmNsYXNzTGlzdC5hZGQoJ3Byb2dyZXNzaW9uJyk7XHJcblx0XHR0aGlzLmxhYmVsQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2xhYmVsQ29udGFpbmVyJyk7XHJcblxyXG5cdFx0dGhpcy5sYWJlbENvbnRhaW5lci5hcHBlbmQodGhpcy5sYWJlbE1hdGNoLCB0aGlzLmxhYmVsTGFiZWwsIHRoaXMubGFiZWxWYWx1ZSk7XHJcblxyXG5cdFx0dGhpcy5iYXIuYXBwZW5kKHRoaXMuYmFyUHJvZ3Jlc3Npb24pO1xyXG5cdFx0dGhpcy5iYXIuYXBwZW5kKHRoaXMubGFiZWxDb250YWluZXIpO1xyXG5cdFx0dGhpcy5jb250YWluZXIuYXBwZW5kKHRoaXMuYmFyKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXQgaXNEaXNhYmxlZCh2YWx1ZTogYm9vbGVhbikge1xyXG5cdFx0Y29uc3QgQ0xBU1NfTkFNRSA9ICdkaXNhYmxlZCc7XHJcblx0XHRpZiAodmFsdWUpIHtcclxuXHRcdFx0dGhpcy5iYXIuY2xhc3NMaXN0LmFkZChDTEFTU19OQU1FKTtcclxuXHRcdFx0dGhpcy5iYXJQcm9ncmVzc2lvbi5jbGFzc0xpc3QuYWRkKENMQVNTX05BTUUpO1xyXG5cdFx0XHR0aGlzLmxhYmVsQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoQ0xBU1NfTkFNRSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLmJhci5jbGFzc0xpc3QucmVtb3ZlKENMQVNTX05BTUUpO1xyXG5cdFx0XHR0aGlzLmxhYmVsQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfTkFNRSk7XHJcblx0XHRcdHRoaXMuYmFyUHJvZ3Jlc3Npb24uY2xhc3NMaXN0LnJlbW92ZShDTEFTU19OQU1FKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXQgbGFiZWwodmFsdWU6IHN0cmluZykge1xyXG5cdFx0dGhpcy5sYWJlbExhYmVsLmlubmVyVGV4dCA9IHZhbHVlO1xyXG5cdH1cclxuXHRwdWJsaWMgc2V0IG1hdGNoKHZhbHVlOiBzdHJpbmcpIHtcclxuXHRcdHRoaXMubGFiZWxNYXRjaC5pbm5lclRleHQgPSB2YWx1ZTtcclxuXHR9XHJcblx0cHVibGljIHNldCB2YWx1ZSh2YWx1ZTogc3RyaW5nKSB7XHJcblx0XHR0aGlzLmxhYmVsVmFsdWUuaW5uZXJUZXh0ID0gdmFsdWU7XHJcblx0fVxyXG5cdHB1YmxpYyBzZXQgd2lkdGgodmFsdWU6IHN0cmluZykge1xyXG5cdFx0dGhpcy5iYXJQcm9ncmVzc2lvbi5zdHlsZS53aWR0aCA9IHZhbHVlO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGZhZGVJbihkdXJhdGlvbjogbnVtYmVyLCBkZWxheTogbnVtYmVyID0gMCk6IHZvaWQge1xyXG5cdFx0dGhpcy5iYXIuc3R5bGUuYW5pbWF0aW9uRGVsYXkgPSBgJHtkZWxheX1tc2A7XHJcblx0XHR0aGlzLmJhci5zdHlsZS5hbmltYXRpb25EdXJhdGlvbiA9IGAke2R1cmF0aW9ufW1zYDtcclxuXHRcdHRoaXMuYmFyLmNsYXNzTGlzdC5hZGQoJ3NsaWRlSW4nKTtcclxuXHRcdHRoaXMuYmFyLmNsYXNzTGlzdC5yZW1vdmUoJ3NsaWRlT3V0Jyk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZmFkZU91dChkdXJhdGlvbjogbnVtYmVyLCBkZWxheTogbnVtYmVyID0gMCk6IHZvaWQge1xyXG5cdFx0dGhpcy5iYXIuc3R5bGUuYW5pbWF0aW9uRGVsYXkgPSBgJHtkZWxheX1tc2A7XHJcblx0XHR0aGlzLmJhci5zdHlsZS5hbmltYXRpb25EdXJhdGlvbiA9IGAke2R1cmF0aW9ufW1zYDtcclxuXHRcdHRoaXMuYmFyLmNsYXNzTGlzdC5hZGQoJ3NsaWRlT3V0Jyk7XHJcblx0XHR0aGlzLmJhci5jbGFzc0xpc3QucmVtb3ZlKCdzbGlkZUluJyk7XHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQmFyT3ZlcmxheSB7XHJcblx0cHJpdmF0ZSBjb250YWluZXI6IEhUTUxEaXZFbGVtZW50O1xyXG5cdHByaXZhdGUgYmFyczogQmFyW10gPSBbXTtcclxuXHJcblx0cHVibGljIGNvbnN0cnVjdG9yKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIG92ZXJsYXlDbGllbnQ6IElDaGFvc092ZXJsYXlDbGllbnQpIHtcclxuXHRcdHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG5cclxuXHRcdC8vIEJpbmQgbGlzdGVuZXIgbWV0aG9kc1xyXG5cdFx0dGhpcy5vbkNyZWF0ZVZvdGUgPSB0aGlzLm9uQ3JlYXRlVm90ZS5iaW5kKHRoaXMpO1xyXG5cdFx0dGhpcy5vbkRpc2Nvbm5lY3QgPSB0aGlzLm9uRGlzY29ubmVjdC5iaW5kKHRoaXMpO1xyXG5cdFx0dGhpcy5vbkVuZFZvdGUgPSB0aGlzLm9uRW5kVm90ZS5iaW5kKHRoaXMpO1xyXG5cdFx0dGhpcy5vblVwZGF0ZVZvdGUgPSB0aGlzLm9uVXBkYXRlVm90ZS5iaW5kKHRoaXMpO1xyXG5cclxuXHRcdC8vIEFkZCBsaXN0ZW5lciB0byB0aGUgb3ZlcmxheSBjbGllbnRcclxuXHRcdG92ZXJsYXlDbGllbnQuYWRkQ3JlYXRlVm90ZUxpc3RlbmVyKHRoaXMub25DcmVhdGVWb3RlKTtcclxuXHRcdG92ZXJsYXlDbGllbnQuYWRkRGlzY29ubmVjdExpc3RlbmVyKHRoaXMub25EaXNjb25uZWN0KTtcclxuXHRcdG92ZXJsYXlDbGllbnQuYWRkRW5kVm90ZUxpc3RlbmVyKHRoaXMub25FbmRWb3RlKTtcclxuXHRcdG92ZXJsYXlDbGllbnQuYWRkVXBkYXRlVm90ZUxpc3RlbmVyKHRoaXMub25VcGRhdGVWb3RlKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgb25DcmVhdGVWb3RlKCk6IHZvaWQge1xyXG5cdFx0dGhpcy5iYXJzLmZvckVhY2goKGJhciwgaW5kZXgpID0+IHtcclxuXHRcdFx0Y29uc3QgQU5JTUFUSU9OX0RFTEFZID0gaW5kZXggKiBBTklNQVRJT05fREVMQVlfREVMVEE7XHJcblx0XHRcdGJhci5mYWRlT3V0KEFOSU1BVElPTl9MRU5HVEgsIEFOSU1BVElPTl9ERUxBWSk7XHJcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0XHRcdGJhci5pc0Rpc2FibGVkID0gZmFsc2U7XHJcblx0XHRcdFx0YmFyLmZhZGVJbihBTklNQVRJT05fTEVOR1RILCBBTklNQVRJT05fREVMQVkpO1xyXG5cdFx0XHR9LCBBTklNQVRJT05fTEVOR1RIICsgQU5JTUFUSU9OX0RFTEFZKTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHRwcml2YXRlIG9uRGlzY29ubmVjdCgpOiB2b2lkIHtcclxuXHRcdHRoaXMuYmFycy5mb3JFYWNoKChiYXIsIGluZGV4KSA9PiB7XHJcblx0XHRcdGNvbnN0IEFOSU1BVElPTl9ERUxBWSA9IGluZGV4ICogQU5JTUFUSU9OX0RFTEFZX0RFTFRBO1xyXG5cdFx0XHRiYXIuZmFkZU91dChBTklNQVRJT05fTEVOR1RILCBBTklNQVRJT05fREVMQVkpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cdHByaXZhdGUgb25FbmRWb3RlKCk6IHZvaWQge1xyXG5cdFx0dGhpcy5iYXJzLmZvckVhY2goYmFyID0+IChiYXIuaXNEaXNhYmxlZCA9IHRydWUpKTtcclxuXHR9XHJcblx0cHJpdmF0ZSBvblVwZGF0ZVZvdGUobWVzc2FnZTogSUNoYW9zT3ZlcmxheUNsaWVudE1lc3NhZ2UpOiB2b2lkIHtcclxuXHRcdGNvbnN0IHsgcmV0YWluSW5pdGlhbFZvdGVzLCB2b3RlT3B0aW9ucywgdm90aW5nTW9kZSB9ID0gbWVzc2FnZTtcclxuXHRcdGxldCB7IHRvdGFsVm90ZXMgfSA9IG1lc3NhZ2U7XHJcblxyXG5cdFx0aWYgKHZvdGluZ01vZGUgPT09ICdQRVJDRU5UQUdFJyAmJiAodG90YWxWb3RlcyA9PT0gMCB8fCByZXRhaW5Jbml0aWFsVm90ZXMpKSB7XHJcblx0XHRcdHRvdGFsVm90ZXMgKz0gdm90ZU9wdGlvbnMubGVuZ3RoO1xyXG5cdFx0XHR2b3RlT3B0aW9ucy5mb3JFYWNoKF8gPT4gXy52YWx1ZSsrKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAodm90ZU9wdGlvbnMubGVuZ3RoICE9PSB0aGlzLmJhcnMubGVuZ3RoKSB7XHJcblx0XHRcdHdoaWxlICh0aGlzLmNvbnRhaW5lci5maXJzdENoaWxkKSB0aGlzLmNvbnRhaW5lci5yZW1vdmVDaGlsZCh0aGlzLmNvbnRhaW5lci5maXJzdENoaWxkKTtcclxuXHRcdFx0dGhpcy5iYXJzID0gdm90ZU9wdGlvbnMubWFwKF8gPT4gbmV3IEJhcih0aGlzLmNvbnRhaW5lcikpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdm90ZU9wdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0Y29uc3QgQkFSID0gdGhpcy5iYXJzW2ldO1xyXG5cdFx0XHRjb25zdCBWT1RFX09QVElPTiA9IHZvdGVPcHRpb25zW2ldO1xyXG5cclxuXHRcdFx0Ly8gV2Ugb25seSB3YW50IHRvIHVwZGF0ZSB0aGUgYmFyIHdoZW4gaXQncyBub3QgZGlzYWJsZWQuIEEgYmFyIGlzIGRpc2FibGVkXHJcblx0XHRcdC8vIGFmdGVyIGEgdm90ZSBlbmRlZCwgdW50aWwgaXQgaXMgb3V0IG9mIHZpZXcgKGZhZGUgb3V0KS5cclxuXHRcdFx0aWYgKEJBUi5pc0Rpc2FibGVkKSBjb250aW51ZTtcclxuXHJcblx0XHRcdGxldCBwZXJjZW50YWdlID0gMDtcclxuXHRcdFx0aWYgKFZPVEVfT1BUSU9OLnZhbHVlID09PSAwKSBwZXJjZW50YWdlID0gMDtcclxuXHRcdFx0ZWxzZSBwZXJjZW50YWdlID0gTWF0aC5mbG9vcigoVk9URV9PUFRJT04udmFsdWUgLyB0b3RhbFZvdGVzKSAqIDEwMCk7XHJcblxyXG5cdFx0XHRCQVIubGFiZWwgPSBWT1RFX09QVElPTi5sYWJlbDtcclxuXHRcdFx0QkFSLm1hdGNoID0gVk9URV9PUFRJT04ubWF0Y2hlcy5qb2luKCcvJykuY29uY2F0KCcuJyk7XHJcblxyXG5cdFx0XHRpZiAodm90aW5nTW9kZSA9PT0gJ01BSk9SSVRZJyB8fCB2b3RpbmdNb2RlID09PSAnQU5USU1BSk9SSVRZJykge1xyXG5cdFx0XHRcdEJBUi52YWx1ZSA9IFZPVEVfT1BUSU9OLnZhbHVlLnRvU3RyaW5nKCk7XHJcblx0XHRcdH0gZWxzZSBpZiAodm90aW5nTW9kZSA9PT0gJ1BFUkNFTlRBR0UnKSB7XHJcblx0XHRcdFx0QkFSLnZhbHVlID0gYCR7cGVyY2VudGFnZX0lYDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0QkFSLndpZHRoID0gYCR7cGVyY2VudGFnZX0lYDtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuIiwiaW1wb3J0IHsgQ2hhb3NPdmVybGF5Q2xpZW50IH0gZnJvbSAnLi9jaGFvc092ZXJsYXlDbGllbnQnO1xyXG5pbXBvcnQgeyBCYXJPdmVybGF5IH0gZnJvbSAnLi9iYXJPdmVybGF5JztcclxuXHJcbi8vIEdldCBET00gZWxlbWVudHNcclxuY29uc3QgQkFSX0NPTlRBSU5FUiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYXJDb250YWluZXInKSBhcyBIVE1MRGl2RWxlbWVudCB8IG51bGw7XHJcbmNvbnN0IFRPVEFMX1ZPVEVTID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvdGFsVm90ZXMnKSBhcyBIVE1MRGl2RWxlbWVudCB8IG51bGw7XHJcblxyXG5pZiAoQkFSX0NPTlRBSU5FUiA9PT0gbnVsbCkgdGhyb3cgbmV3IEVycm9yKCdjb3VsZCBub3QgZmluZCBiYXIgY29udGFpbmVyIGluIERPTScpO1xyXG5pZiAoVE9UQUxfVk9URVMgPT09IG51bGwpIHRocm93IG5ldyBFcnJvcignY291bGQgbm90IGZpbmQgdG90YWwgdm90ZXMgZWxlbWVudCBpbiBET00nKTtcclxuXHJcbmNvbnN0IE9WRVJMQVlfQ0xJRU5UID0gbmV3IENoYW9zT3ZlcmxheUNsaWVudCgnd3M6Ly9sb2NhbGhvc3Q6OTA5MScpO1xyXG5cclxuT1ZFUkxBWV9DTElFTlQuYWRkQ29ubmVjdExpc3RlbmVyKCgpID0+IHtcclxuXHRUT1RBTF9WT1RFUy5zdHlsZS5vcGFjaXR5ID0gJzEnO1xyXG59KTtcclxuT1ZFUkxBWV9DTElFTlQuYWRkRGlzY29ubmVjdExpc3RlbmVyKCgpID0+IHtcclxuXHRUT1RBTF9WT1RFUy5zdHlsZS5vcGFjaXR5ID0gJzAnO1xyXG59KTtcclxuT1ZFUkxBWV9DTElFTlQuYWRkVXBkYXRlVm90ZUxpc3RlbmVyKG1lc3NhZ2UgPT4ge1xyXG5cdFRPVEFMX1ZPVEVTLmlubmVyVGV4dCA9IGBUb3RhbCBWb3RlczogJHttZXNzYWdlLnRvdGFsVm90ZXN9YDtcclxufSk7XHJcblxyXG5uZXcgQmFyT3ZlcmxheShCQVJfQ09OVEFJTkVSLCBPVkVSTEFZX0NMSUVOVCk7XHJcbiJdLCJuYW1lcyI6WyJoYW5kbGVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJoYW5kbGVyIiwidGhpcyIsInB1c2giLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZmlsdGVyIiwiaCIsImRpc3BhdGNoIiwiZGF0YSIsInNsaWNlIiwiZm9yRWFjaCIsIlVSTCIsIldTIiwiY3JlYXRlRXZlbnQiLCJMaXRlRXZlbnQiLCJjb25uZWN0RXZlbnQiLCJkaXNjb25uZWN0RXZlbnQiLCJlbmRFdmVudCIsIm5vVm90ZVJvdW5kRXZlbnQiLCJ1cGRhdGVFdmVudCIsIm9uU29ja2V0Q2xvc2UiLCJiaW5kIiwib25Tb2NrZXRFcnJvciIsIm9uU29ja2V0TWVzc2FnZSIsIm9uU29ja2V0T3BlbiIsImNvbm5lY3QiLCJhZGRDcmVhdGVWb3RlTGlzdGVuZXIiLCJsaXN0ZW5lciIsImFkZENvbm5lY3RMaXN0ZW5lciIsImFkZERpc2Nvbm5lY3RMaXN0ZW5lciIsImFkZEVuZFZvdGVMaXN0ZW5lciIsImFkZE5vVm90aW5nUm91bmRMaXN0ZW5lciIsImFkZFVwZGF0ZVZvdGVMaXN0ZW5lciIsInJlbW92ZUNyZWF0ZVZvdGVMaXN0ZW5lciIsInJlbW92ZUNvbm5lY3RMaXN0ZW5lciIsInJlbW92ZURpc2Nvbm5lY3RMaXN0ZW5lciIsInJlbW92ZUVuZFZvdGVMaXN0ZW5lciIsInJlbW92ZU5vVm90aW5nUm91bmRMaXN0ZW5lciIsInJlbW92ZVVwZGF0ZVZvdGVMaXN0ZW5lciIsIldlYlNvY2tldCIsImUiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJtZXNzYWdlIiwiY2xvc2UiLCJDaGFvc092ZXJsYXlDbGllbnQiLCJSRUNPTk5FQ1RfSU5URVJWQUwiLCJ3aW5kb3ciLCJzZXRUaW1lb3V0IiwiTUVTU0FHRSIsIkpTT04iLCJwYXJzZSIsInJlcXVlc3QiLCJ3YXJuIiwiQU5JTUFUSU9OX0xFTkdUSCIsImNvbnRhaW5lciIsImJhciIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImJhclByb2dyZXNzaW9uIiwibGFiZWxDb250YWluZXIiLCJsYWJlbExhYmVsIiwibGFiZWxNYXRjaCIsImxhYmVsVmFsdWUiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmQiLCJ2YWx1ZSIsIkNMQVNTX05BTUUiLCJyZW1vdmUiLCJpbm5lclRleHQiLCJzdHlsZSIsIndpZHRoIiwiZmFkZUluIiwiZHVyYXRpb24iLCJkZWxheSIsImFuaW1hdGlvbkRlbGF5IiwiYW5pbWF0aW9uRHVyYXRpb24iLCJmYWRlT3V0Iiwib3ZlcmxheUNsaWVudCIsImJhcnMiLCJvbkNyZWF0ZVZvdGUiLCJvbkRpc2Nvbm5lY3QiLCJvbkVuZFZvdGUiLCJvblVwZGF0ZVZvdGUiLCJpbmRleCIsIkFOSU1BVElPTl9ERUxBWSIsImlzRGlzYWJsZWQiLCJyZXRhaW5Jbml0aWFsVm90ZXMiLCJ2b3RlT3B0aW9ucyIsInZvdGluZ01vZGUiLCJ0b3RhbFZvdGVzIiwibGVuZ3RoIiwiXyIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsIm1hcCIsIkJhciIsImkiLCJCQVIiLCJWT1RFX09QVElPTiIsInBlcmNlbnRhZ2UiLCJNYXRoIiwiZmxvb3IiLCJsYWJlbCIsIm1hdGNoIiwibWF0Y2hlcyIsImpvaW4iLCJjb25jYXQiLCJ0b1N0cmluZyIsIkJBUl9DT05UQUlORVIiLCJnZXRFbGVtZW50QnlJZCIsIlRPVEFMX1ZPVEVTIiwiRXJyb3IiLCJPVkVSTEFZX0NMSUVOVCIsIm9wYWNpdHkiLCJCYXJPdmVybGF5Il0sInNvdXJjZVJvb3QiOiIifQ==